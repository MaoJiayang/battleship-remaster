# æ­¦å™¨ç³»ç»Ÿé‡æ„è¯¦ç»†å®æ–½æ–¹æ¡ˆ

## æ–‡æ¡£è¯´æ˜
æœ¬æ–‡æ¡£æ˜¯å¯¹åŸ `æ­¦å™¨ç³»ç»Ÿé‡æ„.md` çš„è¡¥å……å’Œç»†åŒ–ï¼ŒåŸºäºå¯¹ç°æœ‰ä»£ç çš„æ·±å…¥åˆ†æï¼Œæä¾›å¯æ‰§è¡Œçš„æ¸è¿›å¼é‡æ„è·¯çº¿å›¾ã€‚

## 1. é‡æ„èƒŒæ™¯ä¸é—®é¢˜è¯Šæ–­

### 1.1 å½“å‰ä»£ç è€¦åˆç‚¹åˆ†æ

#### é—®é¢˜ Aï¼šæ­¦å™¨é€»è¾‘åˆ†æ•£åœ¨å¤šå¤„
```javascript
// ä½ç½®1: handleEnemyGridHover (L401-426) - é¢„è§ˆèŒƒå›´
if (currentWeapon === 'AP') { /* å•ç‚¹ */ }
else if (currentWeapon === 'HE') { /* Xå‹5æ ¼ */ }
else if (currentWeapon === 'SONAR') { /* 3x3 */ }

// ä½ç½®2: clickEnemy (L1203-1300) - ç©å®¶æ”»å‡»
if (currentWeapon === 'AP') { /* ä¸»ç‚®é€»è¾‘ */ }
else if (currentWeapon === 'HE') { /* ç©ºè¢­é€»è¾‘ */ }
else if (currentWeapon === 'SONAR') { /* æ°´å¬é€»è¾‘ */ }

// ä½ç½®3: aiTurn (L1419-1490) - AIæ”»å‡»
if (weapon === 'AP') { /* ä¸ç©å®¶é‡å¤çš„ä¸»ç‚®é€»è¾‘ */ }
else if (weapon === 'HE') { /* ä¸ç©å®¶é‡å¤çš„ç©ºè¢­é€»è¾‘ */ }
else if (weapon === 'SONAR') { /* ä¸ç©å®¶é‡å¤çš„æ°´å¬é€»è¾‘ */ }
```

**ä»£ç é‡å¤ç‡**ï¼šçº¦ 80%  
**æ–°å¢æ­¦å™¨æˆæœ¬**ï¼šéœ€åŒæ­¥ä¿®æ”¹ 5-6 å¤„

#### é—®é¢˜ Bï¼šDOM æ“ä½œä¸ä¸šåŠ¡é€»è¾‘æ·±åº¦è€¦åˆ
```javascript
// processHit å‡½æ•°æ··æ‚äº†æ•°æ®æ›´æ–°å’ŒDOMæ“ä½œ
function processHit(r, c, dmg) {
    const cell = enemyGridMap[r][c];  // æ•°æ®å±‚
    const uiCell = document.querySelector(...);  // DOMå±‚
    
    cell.hit = true;  // ä¿®æ”¹æ•°æ®
    uiCell.classList.add('hit');  // ä¿®æ”¹UI
    
    if (ship.hp.every(h => h <= 0)) {
        ship.sunk = true;  // ä¿®æ”¹æ•°æ®
        log(`ã€${ship.name}ã€‘æ²‰æ²¡ï¼`);  // è¾“å‡ºæ—¥å¿—
        revealSingleEnemyShip(ship);  // è§¦å‘åŠ¨ç”»
        checkWin("ç©å®¶");  // æ£€æŸ¥èƒœè´Ÿ
    }
}
```

**å½±å“**ï¼šæ— æ³•å•ç‹¬æµ‹è¯•æ•°æ®å±‚é€»è¾‘ï¼Œæ— æ³•å¤ç”¨åˆ°åŒäºº/è”ç½‘æ¨¡å¼ã€‚

#### é—®é¢˜ Cï¼šæ­¦å™¨ä¾èµ–åˆ¤å®šé‡å¤å®ç°
```javascript
// ç©å®¶ä¾§ï¼šupdateWeaponStates()
const cvAlive = myShips.some(s => s.code === 'CV' && !s.sunk);
document.getElementById('btn-he').disabled = !cvAlive;

// AIä¾§ï¼šcheckAIAbilities() (aiStrategy.js)
const aiCV = enemyShips.some(s => s.code === 'CV' && !s.sunk);
return { canUseAir: aiCV };
```

### 1.2 é‡æ„æ”¶ç›Šé¢„ä¼°

| æŒ‡æ ‡ | ç°çŠ¶ | ç›®æ ‡ | æå‡ |
|------|------|------|------|
| æ–°å¢æ­¦å™¨ä»£ç é‡ | ~150è¡Œ (åˆ†æ•£5å¤„) | ~50è¡Œ (1ä¸ªæ–‡ä»¶) | å‡å°‘ 67% |
| ä»£ç é‡å¤ç‡ | 80% | <10% | å‡å°‘ 70% |
| å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | ~0% | 80%+ | æ–°å¢èƒ½åŠ› |
| ç©å®¶/AIä¸€è‡´æ€§ | æ‰‹åŠ¨ä¿è¯ | æ¶æ„ä¿è¯ | æ¶ˆé™¤é£é™© |

---

## 2. é‡æ„ç­–ç•¥ï¼šæ¸è¿›å¼åŒè·¯å¾„å¹¶è¡Œ

### 2.1 æ ¸å¿ƒåŸåˆ™
1. **æ¯ä¸€æ­¥éƒ½ä¿æŒæ¸¸æˆå¯è¿è¡Œ** - ç»ä¸å‡ºç°"ä»£ç ä¸€åŠæ–°ä¸€åŠæ—§å¯¼è‡´å´©æºƒ"
2. **å…ˆéªŒè¯ä¸€ç§æ­¦å™¨** - APæ­¦å™¨ä½œä¸ºè¯•ç‚¹ï¼ŒéªŒè¯æ•´å¥—æµç¨‹
3. **ä¿ç•™æ—§è·¯å¾„ä½œä¸º fallback** - å‡ºé—®é¢˜å¯ç«‹å³å›é€€
4. **åˆ†é˜¶æ®µæäº¤ä»£ç ** - æ¯å®Œæˆä¸€ä¸ª Step å³å¯å‘å¸ƒ

### 2.2 å®æ–½é‡Œç¨‹ç¢‘

```
ç¬¬ä¸€é˜¶æ®µï¼ˆæ ¸å¿ƒéªŒè¯ï¼‰       ç¬¬äºŒé˜¶æ®µï¼ˆå…¨é¢è¿ç§»ï¼‰      ç¬¬ä¸‰é˜¶æ®µï¼ˆä¼˜åŒ–å®Œå–„ï¼‰
â”œâ”€ Step 0: æ•°æ®æ¨¡å‹       â”œâ”€ Step 6: HE/SONAR     â”œâ”€ Step 8: æ¸…ç†æ—§ä»£ç 
â”œâ”€ Step 2: æ¸²æŸ“å™¨æ‹†åˆ†     â”œâ”€ Step 7: AIé€»è¾‘è¿ç§»   â”œâ”€ Step 9: æ–‡æ¡£ä¸æµ‹è¯•
â””â”€ Step 5: APæ­¦å™¨éªŒè¯     â””â”€ éªŒè¯ï¼šæ‰€æœ‰æ­¦å™¨å¯ç”¨   â””â”€ äº¤ä»˜ï¼šä»£ç åº“æ•´æ´
   â””â”€ äº¤ä»˜ï¼šä¸»ç‚®å¯ç”¨
```

---

## 3. è¯¦ç»†å®æ–½è®¡åˆ’

### Step 0ï¼šæ•°æ®æ¨¡å‹ç»Ÿä¸€ â­

**é¢„è®¡æ—¶é—´**ï¼š1-2 å°æ—¶  
**ä¼˜å…ˆçº§**ï¼šğŸ”¥ é«˜ï¼ˆå¿…é¡»æœ€å…ˆå®Œæˆï¼‰  
**é£é™©ç­‰çº§**ï¼šğŸŸ¢ ä½

#### ä»»åŠ¡ 0.1ï¼šè¡¥å…… WeaponTypes.js æ•°æ®ç»“æ„

```javascript
// src/game/weapons/WeaponTypes.js (è¿½åŠ å†…å®¹)

/**
 * æ ¼å­çŠ¶æ€çš„å®Œæ•´æè¿°
 */
export class GridState {
    constructor() {
        this.hit = false;           // æ˜¯å¦è¢«æ”»å‡»è¿‡
        this.shipId = -1;           // æ‰€å±èˆ¹åªIDï¼ˆ-1è¡¨ç¤ºæ— èˆ¹ï¼‰
        this.segmentIndex = -1;     // èˆ¹ä½“æ®µç´¢å¼•
        this.state = 'UNKNOWN';     // UNKNOWN/MISS/HIT/DESTROYED/SUSPECT/SUNK
    }
    
    static fromExisting(cell) {
        const state = new GridState();
        state.hit = cell.hit;
        state.shipId = cell.shipId;
        state.segmentIndex = cell.segmentIndex;
        return state;
    }
}

/**
 * èˆ¹åªçŠ¶æ€çš„å¿«ç…§ï¼ˆç”¨äºä¼ é€’ç»™æ­¦å™¨ï¼Œé¿å…ç›´æ¥ä¿®æ”¹åŸå¯¹è±¡ï¼‰
 */
export class ShipState {
    constructor(ship) {
        this.id = ship.id;
        this.code = ship.code;      // BB/CV/CL/DD/SS
        this.name = ship.name;
        this.len = ship.len;
        this.maxHp = ship.maxHp;
        this.hp = [...ship.hp];     // æ·±æ‹·è´è¡€é‡æ•°ç»„
        this.sunk = ship.sunk;
        
        // ä½ç½®ä¿¡æ¯ï¼ˆAIéœ€è¦ï¼‰
        this.r = ship.r ?? -1;
        this.c = ship.c ?? -1;
        this.vertical = ship.vertical ?? false;
    }
}

/**
 * äº‹ä»¶è´Ÿè½½çš„æ˜ç¡®è§„èŒƒï¼ˆç”¨äºæ–‡æ¡£å’Œç±»å‹æ£€æŸ¥ï¼‰
 */
export const EVENT_PAYLOADS = {
    CELL_UPDATE: {
        grid: 'PLAYER'|'ENEMY',     // ç›®æ ‡ç½‘æ ¼
        r: 'number',
        c: 'number',
        state: 'HIT'|'DESTROYED'|'MISS'|'SUSPECT',
        markClass: 'string?'         // å¯é€‰çš„é¢å¤–CSSç±»
    },
    SHIP_UPDATE: {
        shipId: 'number',
        segmentIndex: 'number',
        newHp: 'number',
        sunk: 'boolean'
    },
    LOG: {
        message: 'string',
        className: 'c-p'|'c-e'|'c-sys'|'c-warn'
    },
    EFFECT: {
        type: 'explosion'|'splash'|'scan',
        positions: '[{r, c}]',
        duration: 'number'
    }
};
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æ–‡ä»¶æ— è¯­æ³•é”™è¯¯ï¼Œå¯æ­£å¸¸å¯¼å…¥
- [ ] `GridState.fromExisting` èƒ½æ­£ç¡®è½¬æ¢ç°æœ‰æ ¼å­æ•°æ®
- [ ] `ShipState` æ„é€ å™¨èƒ½å¤„ç†æ‰€æœ‰èˆ¹å‹

---

#### ä»»åŠ¡ 0.2ï¼šåˆ›å»º BattleRenderer

```javascript
// src/game/battle/BattleRenderer.jsï¼ˆå·²å®Œæˆï¼‰
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] èƒ½æ­£ç¡®æ¸²æŸ“ CELL_UPDATE äº‹ä»¶
- [ ] èƒ½æ­£ç¡®è¾“å‡º LOG äº‹ä»¶
- [ ] èƒ½å¤„ç†æ— æ•ˆè¾“å…¥è€Œä¸å´©æºƒ
- [ ] æ•Œæ–¹èˆ¹åªæ²‰æ²¡æ—¶è‡ªåŠ¨è°ƒç”¨ revealSingleEnemyShip

---

#### ä»»åŠ¡ 0.3ï¼šåˆ›å»ºæ•°æ®å±‚ç»“ç®—å‡½æ•°

```javascript
// src/game/battle/HitResolver.jsï¼ˆå·²å®Œæˆï¼‰
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] èƒ½æ­£ç¡®è®¡ç®—å‘½ä¸­/æœªå‘½ä¸­
- [ ] èƒ½æ­£ç¡®æ‰£è¡€å¹¶æ£€æµ‹æ²‰èˆ¹
- [ ] è¿”å›çš„äº‹ä»¶æ•°ç»„æ ¼å¼æ­£ç¡®
- [ ] **ä¸ä¾èµ–ä»»ä½• DOM æ“ä½œ**
- [ ] æ·»åŠ äº†è¾¹ç•Œæ£€æŸ¥å’Œ resolveMultiHit å‡½æ•°

---

#### ä»»åŠ¡ 0.4ï¼šåˆ›å»º SonarResolverï¼ˆæ–°å¢ï¼‰

```javascript
// src/game/battle/SonarResolver.jsï¼ˆå·²å®Œæˆï¼‰
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] èƒ½æ­£ç¡®æ‰«æ 3x3 åŒºåŸŸ
- [ ] æœ‰ä¿¡å·æ—¶ï¼šä¸­å¿ƒç‚¹æ˜¾å½¢ + å‘¨å›´æ ‡è®°ç–‘ä¼¼
- [ ] æ— ä¿¡å·æ—¶ï¼šå…¨éƒ¨æ ‡è®°ä¸º miss
- [ ] è¿”å›æ­£ç¡®çš„äº‹ä»¶æ ¼å¼

---

#### ä»»åŠ¡ 0.5ï¼šä¿®æ­£ WeaponServiceï¼ˆæ–°å¢ï¼‰

**å·²ä¿®æ­£é—®é¢˜**ï¼š
- [ ] ç»Ÿä¸€åœ¨ `_applyResult` ä¸­æ³¨å…¥ `grid` å‚æ•°
- [ ] AI æ”»å‡»æ—¶è‡ªåŠ¨æ·»åŠ  `last-enemy-attack` æ ‡è®°
- [ ] åˆ é™¤æ—¥å¿—é‡å¤å¤„ç†ï¼Œåªé€šè¿‡ renderer ç»Ÿä¸€è¾“å‡º

---

### Step 2ï¼šï¼ˆå·²æ‹†åˆ†åˆ° Step 0ï¼‰

åŸ Step 2 çš„å†…å®¹å·²æ•´åˆåˆ° Step 0 ä¸­ã€‚

---

### Step 5ï¼šå®ç°ç¬¬ä¸€ä¸ªæ­¦å™¨ - APï¼ˆä¸»ç‚®ï¼‰

**é¢„è®¡æ—¶é—´**ï¼š3-4 å°æ—¶  
**ä¼˜å…ˆçº§**ï¼šğŸ”¥ é«˜  
**é£é™©ç­‰çº§**ï¼šğŸŸ¡ ä¸­ï¼ˆéœ€ä»”ç»†æµ‹è¯•ï¼‰

#### ä»»åŠ¡ 5.1ï¼šåˆ›å»º APWeapon.js

```javascript
// src/game/weapons/APWeapon.jsï¼ˆå·²å®Œæˆï¼‰
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] èƒ½æ­£ç¡®è¿”å›é¢„è§ˆèŒƒå›´
- [ ] èƒ½æ­£ç¡®è®¡ç®—ä¼¤å®³ï¼ˆBB/SS=3, CL=2, å…¶ä»–=1ï¼‰
- [ ] ç”Ÿæˆçš„äº‹ä»¶ä¸æ‰‹åŠ¨æ³¨å…¥ gridï¼ˆç”± Service ç»Ÿä¸€å¤„ç†ï¼‰
- [ ] æ—¥å¿—æ¶ˆæ¯æ­£ç¡®åŒºåˆ†ç©å®¶/AI

---

#### ä»»åŠ¡ 5.2ï¼šåœ¨ game.js ä¸­åˆå§‹åŒ–æ­¦å™¨ç³»ç»Ÿ

```javascript
// src/game/game.jsï¼ˆå·²å®Œæˆï¼‰
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æ­£ç¡®å¯¼å…¥æ‰€æœ‰æ­¦å™¨ç³»ç»Ÿæ¨¡å—
- [ ] åœ¨ initGame ä¸­åˆå§‹åŒ– weaponRegistry, battleRenderer, weaponService
- [ ] åˆ›å»º buildPlayerWeaponContext å’Œ buildAiWeaponContext å‡½æ•°
- [ ] æš´éœ² revealSingleEnemyShip åˆ° window å¯¹è±¡

---

#### ä»»åŠ¡ 5.3ï¼šä¿®æ”¹ clickEnemy ä½¿ç”¨åŒè·¯å¾„

```javascript
// src/game/game.jsï¼ˆå·²å®Œæˆï¼‰
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] AP æ­¦å™¨ä½¿ç”¨æ–°è·¯å¾„ï¼ˆweaponServiceï¼‰
- [ ] HE å’Œ SONAR ä¿ç•™æ—§è·¯å¾„
- [ ] æ­£ç¡®æ£€æŸ¥èƒœè´Ÿï¼ˆé€šè¿‡ SHIP_UPDATE äº‹ä»¶ï¼‰

---

#### ä»»åŠ¡ 5.4ï¼šæµ‹è¯•éªŒè¯ [ ]

**æ‰‹åŠ¨æµ‹è¯•æ¸…å•**ï¼š
- [ ] æ¡Œé¢ç«¯ï¼šç‚¹å‡»æ•Œæ–¹æ ¼å­ï¼Œä¸»ç‚®èƒ½æ­£å¸¸æ”»å‡»
- [ ] ç§»åŠ¨ç«¯ï¼šç‚¹å‡»æ•Œæ–¹æ ¼å­ï¼Œä¸»ç‚®èƒ½æ­£å¸¸æ”»å‡»
- [ ] å‘½ä¸­èˆ¹åªï¼šæ˜¾ç¤º hit/destroyed æ ·å¼æ­£ç¡®
- [ ] æœªå‘½ä¸­ï¼šæ˜¾ç¤º miss æ ·å¼æ­£ç¡®
- [ ] æ²‰èˆ¹æ£€æµ‹ï¼šæ‰€æœ‰æ ¼å­ destroyed åè§¦å‘æ²‰èˆ¹
- [ ] æ—¥å¿—è¾“å‡ºï¼šæ—¶é—´ã€æ¶ˆæ¯ã€é¢œè‰²æ­£ç¡®
- [ ] ä¼¤å®³è®¡ç®—ï¼š
  - [ ] BB å­˜æ´»æ—¶ä¼¤å®³=3
  - [ ] SS å­˜æ´»æ—¶ä¼¤å®³=3
  - [ ] ä»… CL å­˜æ´»æ—¶ä¼¤å®³=2
  - [ ] æ‰€æœ‰å¤§èˆ¹æ²‰æ²¡æ—¶ä¼¤å®³=1
- [ ] HE å’Œ SONAR ä»ä½¿ç”¨æ—§è·¯å¾„ï¼ŒåŠŸèƒ½æ­£å¸¸

---

### Step 6ï¼šè¿ç§» HE å’Œ SONAR

**é¢„è®¡æ—¶é—´**ï¼šå„ 2 å°æ—¶  
**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ ä¸­

ï¼ˆè¯¦ç»†ä»£ç çœç•¥ï¼Œç»“æ„ä¸ AP ç±»ä¼¼ï¼‰

**HEWeapon å…³é”®ç‚¹**ï¼š
- `previewArea` è¿”å› X å‹ 5 æ ¼
- `resolve` éå† 5 æ ¼è°ƒç”¨ `resolveHit(nr, nc, 1)`
- `canUse` æ£€æŸ¥ CV å­˜æ´»ï¼š`attackerShips.some(s => s.code === 'CV' && !s.sunk)`

**SonarWeapon å…³é”®ç‚¹**ï¼š
- `previewArea` è¿”å› 3x3 æ ¼
- `resolve` å®ç°æ‰«æé€»è¾‘ï¼ˆéœ€å•ç‹¬è®¾è®¡ SonarResolverï¼‰
- `canUse` æ£€æŸ¥ DD å­˜æ´»

---

### Step 7ï¼šè¿ç§» AI é€»è¾‘

**é¢„è®¡æ—¶é—´**ï¼š1-2 å°æ—¶  
**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ ä¸­

```javascript
// src/game/game.js

function aiTurn() {
    if (gameState !== 'PLAYING') return;
    clearLastEnemyAttacks();

    const context = buildAiWeaponContext();
    const decision = makeAIDecision({
        viewGrid: getAiViewGrid(),
        myShips,
        enemyShips,
        difficultyConfig: AI_PROB_CONFIG
    });

    // ä½¿ç”¨æ–°è·¯å¾„
    const result = weaponService.executeAiAction(decision, context);
    
    // æ£€æŸ¥èƒœè´Ÿ
    if (result && result.events.some(e => e.type === 'SHIP_UPDATE' && e.payload.sunk)) {
        checkWin("ç”µè„‘");
    }

    updateStatus();
    if (showAiDebug) updateAiHeatmapVisuals();
    
    const enemyGridEl = document.getElementById('enemy-grid');
    if (gameState === 'PLAYING') {
        enemyGridEl.style.pointerEvents = 'auto';
        const timing = getTiming();
        if (timing.TURN_BACK_DELAY > 0) {
            setTimeout(() => {
                if(gameState === 'PLAYING') switchMobileView('enemy');
            }, timing.TURN_BACK_DELAY);
        }
    } else {
        enemyGridEl.style.pointerEvents = 'none';
    }
}
```

---

### Step 8ï¼šæ¸…ç†æ—§ä»£ç 

**é¢„è®¡æ—¶é—´**ï¼š2-3 å°æ—¶  
**ä¼˜å…ˆçº§**ï¼šğŸŸ¢ ä½

- [ ] åˆ é™¤ `processHit` å‡½æ•°
- [ ] åˆ é™¤ `aiProcessHit` å‡½æ•°
- [ ] åˆ é™¤ `clickEnemy` ä¸­çš„æ­¦å™¨åˆ†æ”¯
- [ ] åˆ é™¤ `aiTurn` ä¸­çš„æ­¦å™¨åˆ†æ”¯
- [ ] ç®€åŒ– `handleEnemyGridHover`ï¼Œæ”¹ç”¨ `weaponService.handleHover()`

---

### Step 9ï¼šæ–‡æ¡£ä¸æµ‹è¯•

**é¢„è®¡æ—¶é—´**ï¼š2-3 å°æ—¶  
**ä¼˜å…ˆçº§**ï¼šğŸŸ¢ ä½

- [ ] æ›´æ–° `docs/è®¾å®š.md`
- [ ] åœ¨åŸ `æ­¦å™¨ç³»ç»Ÿé‡æ„.md` ä¸­æ ‡è®°å·²å®Œæˆ
- [ ] å›å½’æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
- [ ] ç¼–å†™æ–°å¢æ­¦å™¨çš„æ¨¡æ¿ä»£ç 

---

## 4. é£é™©è¯„ä¼°ä¸åº”å¯¹

| é£é™©é¡¹ | ç­‰çº§ | åº”å¯¹ç­–ç•¥ |
|--------|------|---------|
| æ¸²æŸ“é”™è¯¯ | ğŸ”´ é«˜ | åŒè·¯å¾„å¹¶è¡Œï¼Œå……åˆ†æµ‹è¯• |
| æ•°æ®ä¸ä¸€è‡´ | ğŸŸ¡ ä¸­ | ä½¿ç”¨ ShipState å¿«ç…§ï¼Œé¿å…æ„å¤–ä¿®æ”¹ |
| AI å¤±æ•ˆ | ğŸŸ¡ ä¸­ | AI æœ€åè¿ç§»ï¼Œå…ˆç¡®ä¿ç©å®¶ä¾§ç¨³å®š |
| æ€§èƒ½ä¸‹é™ | ğŸŸ¢ ä½ | å›åˆåˆ¶æ¸¸æˆï¼Œæ€§èƒ½éç“¶é¢ˆ |

---

## 5. æ€»å·¥ä½œé‡

| é˜¶æ®µ | æ—¶é—´ |
|------|------|
| Step 0 | 1-2 h |
| Step 5 | 3-4 h |
| Step 6 | 4 h |
| Step 7 | 1-2 h |
| Step 8 | 2-3 h |
| Step 9 | 2-3 h |
| **æ€»è®¡** | **15-20 h** |

å¯åˆ† 3-4 æ¬¡è¿­ä»£å®Œæˆï¼Œæ¯æ¬¡ 4-6 å°æ—¶ã€‚

---

## 6. æ–°å¢æ­¦å™¨ç¤ºä¾‹

é‡æ„å®Œæˆåï¼Œæ–°å¢æ­¦å™¨ä»…éœ€ï¼š

```javascript
// src/game/weapons/MissileWeapon.js
import { WeaponBase } from './WeaponBase.js';

export class MissileWeapon extends WeaponBase {
    constructor() {
        super({ id: 'MISSILE', label: 'å¯¼å¼¹', icon: 'ğŸš€' });
    }
    
    canUse(context) {
        // æ£€æŸ¥æ˜¯å¦æœ‰å·¡æ´‹èˆ°
        return context.attackerShips.some(s => s.code === 'CL' && !s.sunk);
    }
    
    previewArea(target) {
        // 2x2 æ–¹å½¢åŒºåŸŸ
        const { r, c } = target;
        return {
            cells: [
                { r, c }, { r, c: c+1 },
                { r: r+1, c }, { r: r+1, c: c+1 }
            ]
        };
    }
    
    resolve(target, context) {
        // å®ç°æ”»å‡»é€»è¾‘...
    }
}

// åœ¨ game.js ä¸­æ³¨å†Œ
weaponRegistry.register(new MissileWeapon());
```

**æˆæœ¬å¯¹æ¯”**ï¼š
- æ—§æ¶æ„ï¼š~150è¡Œï¼Œæ”¹5å¤„
- æ–°æ¶æ„ï¼š~50è¡Œï¼Œæ”¹1å¤„

---

## 7. åç»­æ‰©å±•æ–¹å‘

- æ­¦å™¨å†·å´ç³»ç»Ÿ
- ä¼¤å®³ç±»å‹ä¸æŠ¤ç”²
- è¿å‡»æœºåˆ¶
- ç‰¹æ®Šæ•ˆæœï¼ˆDOTã€æ§åˆ¶ï¼‰
- æ­¦å™¨å‡çº§ç³»ç»Ÿ

ä»¥ä¸Šæ‰©å±•åœ¨æ–°æ¶æ„ä¸‹å‡å¯è½»æ¾å®ç°ã€‚
